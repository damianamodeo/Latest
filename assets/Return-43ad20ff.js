import{j as e,r as h}from"./index-110398ee.js";import{M as $,T as w}from"./Modal-4c33a2b8.js";import{r as v,f as j,b as A,C as M,c as S}from"./Center-bb73a4d7.js";import{A as f}from"./Disclosure-53523f17.js";import{B as g}from"./transition-9415720e.js";import{d as y}from"./deleteNotAtHome-ef9f832a.js";const I=async(m,d,i)=>{const x=v(j,"notAtHomes","MaitlandCongregation");try{return await A(j,async t=>{const a=await t.get(x).then(l=>l.data());t.update(x,{...a,[m.key]:{...a[m.key],[d]:i}})})}catch(c){return console.error(c.message),c}},k=({isOpen:m,address:d,setUpdateModelOpen:i})=>e.jsxs($,{onClose:()=>{},title:"",isOpen:m,height:"md",children:[e.jsxs("div",{className:"h-full text-center text-xl dark:text-white",children:[d.unitNumber&&`${d.unitNumber}/`,d.houseNumber," ",d.street,", ",d.suburb]}),e.jsx(M,{children:e.jsxs("div",{className:"grid gap-3",children:[e.jsx(g,{width:"md",clickAction:()=>i(!1),color:"blue",children:"cancel"}),e.jsx(g,{width:"md",clickAction:()=>{I(d,"letter",!0),i(!1)},color:"blue",children:"Letter List"}),e.jsx(g,{width:"md",clickAction:()=>{y(d),i(!1)},color:"blue",children:"Delete"})]})})]}),C=({suburbs:m})=>{const[d,i]=h.useState(!1),[x,c]=h.useState({});return e.jsx("div",{className:"",children:m.filter(t=>t.suburb!==void 0).sort((t,a)=>a.total-t.total).map((t,a)=>e.jsxs("div",{className:"mx-auto w-full max-w-md p-2",children:[e.jsx(f,{title:e.jsxs("div",{className:"p-3 w-full bg-neutral-200 dark:bg-neutral-700  border-black border-[.6px]",children:[`${t.suburb} (${t.total})`," "]}),children:t.streets.sort((l,b)=>l.street.localeCompare(b.street)).map((l,b)=>e.jsx("div",{className:"my-2 mx-6",children:e.jsx(f,{title:e.jsx("div",{className:"p-2 w-full bg-neutral-200 dark:bg-neutral-700 rounded",children:`${l.street} ${l.addresses.length}`}),children:e.jsx("div",{className:" grid grid-cols-[repeat(auto-fill,minmax(3.5rem,1fr))]",children:l.addresses.sort((r,u)=>r.houseNumber-u.houseNumber).map((r,u)=>e.jsx("div",{children:e.jsxs("div",{onClick:()=>{c(r),i(!0)},className:`m-1 py-2 rounded text-center ${r.houseNumber%2===0?"dark:bg-blue-800 bg-blue-300":"dark:bg-green-800 bg-green-300"}`,children:[r.unitNumber&&`${r.unitNumber}/`,r.houseNumber]})},u))})},b)},b))}),d&&e.jsx(k,{isOpen:d,address:x,setUpdateModelOpen:i})]},a))})},L=({mapNumbers:m})=>{console.log("MapsList >>> mapNumbers:",m);const[d,i]=h.useState(!1),[x,c]=h.useState({});return e.jsx("div",{className:"",children:m.filter(t=>t.mapNumber!==void 0).sort((t,a)=>a.total-t.total).map((t,a)=>e.jsxs("div",{className:"mx-auto w-full max-w-md p-2",children:[e.jsx(f,{title:e.jsx("div",{className:"p-3 w-full bg-neutral-200 dark:bg-neutral-700  border-black border-[.6px]",children:`Map ${t.mapNumber} (${t.total})`}),children:t.streets.sort((l,b)=>l.street.localeCompare(b.street)).map((l,b)=>e.jsx("div",{className:"my-2 mx-6",children:e.jsx(f,{title:e.jsx("div",{className:"p-2 w-full bg-neutral-200 dark:bg-neutral-700 rounded",children:`${l.street} ${l.addresses.length}`}),children:e.jsx("div",{className:" grid grid-cols-[repeat(auto-fill,minmax(3.5rem,1fr))]",children:l.addresses.sort((r,u)=>r.houseNumber-u.houseNumber).map((r,u)=>e.jsx("div",{children:e.jsxs("div",{onClick:()=>{c(r),i(!0)},className:`m-1 py-2 rounded text-center ${r.houseNumber%2===0?"dark:bg-blue-800 bg-blue-300":"dark:bg-green-800 bg-green-300"}`,children:[r.unitNumber&&`${r.unitNumber}/`,r.houseNumber]})},u))})},b)},b))}),d&&e.jsx(k,{isOpen:d,address:x,setUpdateModelOpen:i})]},a))})},T=({changeSubpage:m})=>{const[d,i]=h.useState([{key:""}]),[x,c]=h.useState([]),[t,a]=h.useState([]);return h.useEffect(()=>S(v(j,"notAtHomes","MaitlandCongregation"),b=>{const r=b.data(),u=r?Object.keys(r).map(s=>({key:s,...r[s]})):[];i(u),c(u.reduce((s,n)=>{if(n.letter)return s;const o=s.findIndex(p=>p.mapNumber===`${n.mapNumber}`);if(o<0)s.push({mapNumber:n.mapNumber,total:1,streets:[{street:n.street,addresses:[n]}]});else{s[o].total=s[o].total+1;const p=s[o].streets.findIndex(N=>N.street===`${n.street}`);p<0?s[o].streets.push({street:n.street,addresses:[n]}):s[o].streets[p].addresses.push(n)}return s},[])),a(u.reduce((s,n)=>{if(n.letter)return s;const o=s.findIndex(p=>p.suburb===`${n.suburb}`);if(o<0)s.push({suburb:n.suburb,total:1,streets:[{street:n.street,addresses:[n]}]});else{s[o].total=s[o].total+1;const p=s[o].streets.findIndex(N=>N.street===`${n.street}`);p<0?s[o].streets.push({street:n.street,addresses:[n]}):s[o].streets[p].addresses.push(n)}return s},[]))}),[]),e.jsx("div",{className:"h-full",children:e.jsx(w,{color:"blue",tabItems:[{title:"Suburb",content:e.jsx(C,{suburbs:t})},{title:"Map ID",content:e.jsx(L,{mapNumbers:x})}]})})};export{T as default};
