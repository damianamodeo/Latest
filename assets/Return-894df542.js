import{R as j,a as u,d as L,L as C,y as D,T as q,o as y,e as z,g as E,h as I,D as M,I as H,s as Q,i as Y,k as Z,l as k,m as G,j as r,r as U,f as w,b as J,C as W,B as P,c as X}from"./index-cfb3af6b.js";import{M as _,d as V,T as ee}from"./deleteNotAtHome-ed4ea853.js";var B;let te=(B=j.startTransition)!=null?B:function(e){e()};var se=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(se||{}),re=(e=>(e[e.ToggleDisclosure=0]="ToggleDisclosure",e[e.CloseDisclosure=1]="CloseDisclosure",e[e.SetButtonId=2]="SetButtonId",e[e.SetPanelId=3]="SetPanelId",e[e.LinkPanel=4]="LinkPanel",e[e.UnlinkPanel=5]="UnlinkPanel",e))(re||{});let ne={[0]:e=>({...e,disclosureState:E(e.disclosureState,{[0]:1,[1]:0})}),[1]:e=>e.disclosureState===1?e:{...e,disclosureState:1},[4](e){return e.linkedPanel===!0?e:{...e,linkedPanel:!0}},[5](e){return e.linkedPanel===!1?e:{...e,linkedPanel:!1}},[2](e,t){return e.buttonId===t.buttonId?e:{...e,buttonId:t.buttonId}},[3](e,t){return e.panelId===t.panelId?e:{...e,panelId:t.panelId}}},T=u.createContext(null);T.displayName="DisclosureContext";function R(e){let t=u.useContext(T);if(t===null){let i=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,R),i}return t}let A=u.createContext(null);A.displayName="DisclosureAPIContext";function K(e){let t=u.useContext(A);if(t===null){let i=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,K),i}return t}let O=u.createContext(null);O.displayName="DisclosurePanelContext";function le(){return u.useContext(O)}function ae(e,t){return E(t.type,ne,e,t)}let oe=u.Fragment;function ue(e,t){let{defaultOpen:i=!1,...m}=e,f=u.useRef(null),s=D(t,q(g=>{f.current=g},e.as===void 0||e.as===u.Fragment)),o=u.useRef(null),c=u.useRef(null),d=u.useReducer(ae,{disclosureState:i?0:1,linkedPanel:!1,buttonRef:c,panelRef:o,buttonId:null,panelId:null}),[{disclosureState:n,buttonId:p},l]=d,a=y(g=>{l({type:1});let x=Z(f);if(!x||!p)return;let v=(()=>g?g instanceof HTMLElement?g:g.current instanceof HTMLElement?g.current:x.getElementById(p):x.getElementById(p))();v==null||v.focus()}),b=u.useMemo(()=>({close:a}),[a]),h=u.useMemo(()=>({open:n===0,close:a}),[n,a]),N={ref:s};return j.createElement(T.Provider,{value:d},j.createElement(A.Provider,{value:b},j.createElement(z,{value:E(n,{[0]:I.Open,[1]:I.Closed})},M({ourProps:N,theirProps:m,slot:h,defaultTag:oe,name:"Disclosure"}))))}let ie="button";function de(e,t){let i=H(),{id:m=`headlessui-disclosure-button-${i}`,...f}=e,[s,o]=R("Disclosure.Button"),c=le(),d=c===null?!1:c===s.panelId,n=u.useRef(null),p=D(n,t,d?null:s.buttonRef);u.useEffect(()=>{if(!d)return o({type:2,buttonId:m}),()=>{o({type:2,buttonId:null})}},[m,o,d]);let l=y(x=>{var v;if(d){if(s.disclosureState===1)return;switch(x.key){case k.Space:case k.Enter:x.preventDefault(),x.stopPropagation(),o({type:0}),(v=s.buttonRef.current)==null||v.focus();break}}else switch(x.key){case k.Space:case k.Enter:x.preventDefault(),x.stopPropagation(),o({type:0});break}}),a=y(x=>{switch(x.key){case k.Space:x.preventDefault();break}}),b=y(x=>{var v;G(x.currentTarget)||e.disabled||(d?(o({type:0}),(v=s.buttonRef.current)==null||v.focus()):o({type:0}))}),h=u.useMemo(()=>({open:s.disclosureState===0}),[s]),N=Q(e,n),g=d?{ref:p,type:N,onKeyDown:l,onClick:b}:{ref:p,id:m,type:N,"aria-expanded":e.disabled?void 0:s.disclosureState===0,"aria-controls":s.linkedPanel?s.panelId:void 0,onKeyDown:l,onKeyUp:a,onClick:b};return M({ourProps:g,theirProps:f,slot:h,defaultTag:ie,name:"Disclosure.Button"})}let ce="div",pe=L.RenderStrategy|L.Static;function be(e,t){let i=H(),{id:m=`headlessui-disclosure-panel-${i}`,...f}=e,[s,o]=R("Disclosure.Panel"),{close:c}=K("Disclosure.Panel"),d=D(t,s.panelRef,b=>{te(()=>o({type:b?4:5}))});u.useEffect(()=>(o({type:3,panelId:m}),()=>{o({type:3,panelId:null})}),[m,o]);let n=Y(),p=(()=>n!==null?(n&I.Open)===I.Open:s.disclosureState===0)(),l=u.useMemo(()=>({open:s.disclosureState===0,close:c}),[s,c]),a={ref:d,id:m};return j.createElement(O.Provider,{value:s.panelId},M({ourProps:a,theirProps:f,slot:l,defaultTag:ce,features:pe,visible:p,name:"Disclosure.Panel"}))}let me=C(ue),fe=C(de),xe=C(be),$=Object.assign(me,{Button:fe,Panel:xe});const S=({title:e,children:t})=>r.jsxs($,{children:[r.jsx($.Button,{className:"flex w-full justify-between rounded-lg bg-neutral-100 dark:bg-neutral-700  text-left hover:bg-neutral-200 dark:hover:bg-neutral-800 focus:outline-none focus-visible:ring focus-visible:ring-neutral-500 focus-visible:ring-opacity-75",children:e}),r.jsx($.Panel,{className:"",children:t})]}),he=async(e,t,i)=>{const m=U(w,"notAtHomes","MaitlandCongregation");try{return await J(w,async s=>{const o=await s.get(m).then(c=>c.data());s.update(m,{...o,[e.key]:{...o[e.key],[t]:i}})})}catch(f){return console.error(f.message),f}},F=({isOpen:e,address:t,setUpdateModelOpen:i})=>r.jsxs(_,{onClose:()=>{},title:"",isOpen:e,height:"md",children:[r.jsxs("div",{className:"h-full text-center text-xl dark:text-white",children:[t.unitNumber&&`${t.unitNumber}/`,t.houseNumber," ",t.street,", ",t.suburb]}),r.jsx(W,{children:r.jsxs("div",{className:"grid gap-3",children:[r.jsx(P,{width:"md",clickAction:()=>i(!1),color:"blue",children:"cancel"}),r.jsx(P,{width:"md",clickAction:()=>{he(t,"letter",!0)},color:"blue",children:"Letter List"}),r.jsx(P,{width:"md",clickAction:()=>{V(t),i(!1)},color:"blue",children:"Delete"})]})})]}),ge=({suburbs:e})=>{const[t,i]=u.useState(!1),[m,f]=u.useState({});return r.jsx("div",{className:"",children:e.filter(s=>s.suburb!==void 0).sort((s,o)=>o.total-s.total).map((s,o)=>r.jsxs("div",{className:"mx-auto w-full max-w-md p-2",children:[r.jsx(S,{title:r.jsxs("div",{className:"p-3 w-full bg-neutral-200 dark:bg-neutral-700  border-black border-[.6px]",children:[`${s.suburb} (${s.total})`," "]}),children:s.streets.sort((c,d)=>c.street.localeCompare(d.street)).map((c,d)=>r.jsx("div",{className:"my-2 mx-6",children:r.jsx(S,{title:r.jsx("div",{className:"p-2 w-full bg-neutral-200 dark:bg-neutral-700 rounded",children:`${c.street} ${c.addresses.length}`}),children:r.jsx("div",{className:" grid grid-cols-[repeat(auto-fill,minmax(3.5rem,1fr))]",children:c.addresses.sort((n,p)=>n.houseNumber-p.houseNumber).map((n,p)=>r.jsx("div",{children:r.jsxs("div",{onClick:()=>{f(n),i(!0)},className:`m-1 py-2 rounded text-center ${n.houseNumber%2===0?"dark:bg-blue-800 bg-blue-300":"dark:bg-green-800 bg-green-300"}`,children:[n.unitNumber&&`${n.unitNumber}/`,n.houseNumber]})},p))})},d)},d))}),t&&r.jsx(F,{isOpen:t,address:m,setUpdateModelOpen:i})]},o))})},Ne=({mapNumbers:e})=>{console.log("MapsList >>> mapNumbers:",e);const[t,i]=u.useState(!1),[m,f]=u.useState({});return r.jsx("div",{className:"",children:e.filter(s=>s.mapNumber!==void 0).sort((s,o)=>o.total-s.total).map((s,o)=>r.jsxs("div",{className:"mx-auto w-full max-w-md p-2",children:[r.jsx(S,{title:r.jsx("div",{className:"p-3 w-full bg-neutral-200 dark:bg-neutral-700  border-black border-[.6px]",children:`Map ${s.mapNumber} (${s.total})`}),children:s.streets.sort((c,d)=>c.street.localeCompare(d.street)).map((c,d)=>r.jsx("div",{className:"my-2 mx-6",children:r.jsx(S,{title:r.jsx("div",{className:"p-2 w-full bg-neutral-200 dark:bg-neutral-700 rounded",children:`${c.street} ${c.addresses.length}`}),children:r.jsx("div",{className:" grid grid-cols-[repeat(auto-fill,minmax(3.5rem,1fr))]",children:c.addresses.sort((n,p)=>n.houseNumber-p.houseNumber).map((n,p)=>r.jsx("div",{children:r.jsxs("div",{onClick:()=>{f(n),i(!0)},className:`m-1 py-2 rounded text-center ${n.houseNumber%2===0?"dark:bg-blue-800 bg-blue-300":"dark:bg-green-800 bg-green-300"}`,children:[n.unitNumber&&`${n.unitNumber}/`,n.houseNumber]})},p))})},d)},d))}),t&&r.jsx(F,{isOpen:t,address:m,setUpdateModelOpen:i})]},o))})},je=({changeSubpage:e})=>{const[t,i]=u.useState([{key:""}]),[m,f]=u.useState([]),[s,o]=u.useState([]);return u.useEffect(()=>X(U(w,"notAtHomes","MaitlandCongregation"),d=>{const n=d.data(),p=n?Object.keys(n).map(l=>({key:l,...n[l]})):[];i(p),f(p.reduce((l,a)=>{if(a.letter)return l;const b=l.findIndex(h=>h.mapNumber===`${a.mapNumber}`);if(b<0)l.push({mapNumber:a.mapNumber,total:1,streets:[{street:a.street,addresses:[a]}]});else{l[b].total=l[b].total+1;const h=l[b].streets.findIndex(N=>N.street===`${a.street}`);h<0?l[b].streets.push({street:a.street,addresses:[a]}):l[b].streets[h].addresses.push(a)}return l},[])),o(p.reduce((l,a)=>{if(a.letter)return l;const b=l.findIndex(h=>h.suburb===`${a.suburb}`);if(b<0)l.push({suburb:a.suburb,total:1,streets:[{street:a.street,addresses:[a]}]});else{l[b].total=l[b].total+1;const h=l[b].streets.findIndex(N=>N.street===`${a.street}`);h<0?l[b].streets.push({street:a.street,addresses:[a]}):l[b].streets[h].addresses.push(a)}return l},[]))}),[]),r.jsx("div",{className:"h-full",children:r.jsx(ee,{color:"blue",tabItems:[{title:"Suburb",content:r.jsx(ge,{suburbs:s})},{title:"Map",content:r.jsx(Ne,{mapNumbers:m})}]})})};export{je as default};
