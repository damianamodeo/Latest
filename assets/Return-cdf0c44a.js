import{r as v,f as j,b as $,j as e,C as w,B as g,a as p,c as A}from"./index-c534211c.js";import{M,d as S,T as y}from"./deleteNotAtHome-15349680.js";import{A as N}from"./Disclosure-086d54c9.js";const I=async(m,d,i)=>{const h=v(j,"notAtHomes","MaitlandCongregation");try{return await $(j,async t=>{const o=await t.get(h).then(l=>l.data());t.update(h,{...o,[m.key]:{...o[m.key],[d]:i}})})}catch(c){return console.error(c.message),c}},k=({isOpen:m,address:d,setUpdateModelOpen:i})=>e.jsxs(M,{onClose:()=>{},title:"",isOpen:m,height:"md",children:[e.jsxs("div",{className:"h-full text-center text-xl dark:text-white",children:[d.unitNumber&&`${d.unitNumber}/`,d.houseNumber," ",d.street,", ",d.suburb]}),e.jsx(w,{children:e.jsxs("div",{className:"grid gap-3",children:[e.jsx(g,{width:"md",clickAction:()=>i(!1),color:"blue",children:"cancel"}),e.jsx(g,{width:"md",clickAction:()=>{I(d,"letter",!0),i(!1)},color:"blue",children:"Letter List"}),e.jsx(g,{width:"md",clickAction:()=>{S(d),i(!1)},color:"blue",children:"Delete"})]})})]}),C=({suburbs:m})=>{const[d,i]=p.useState(!1),[h,c]=p.useState({});return e.jsx("div",{className:"",children:m.filter(t=>t.suburb!==void 0).sort((t,o)=>o.total-t.total).map((t,o)=>e.jsxs("div",{className:"mx-auto w-full max-w-md p-2",children:[e.jsx(N,{title:e.jsxs("div",{className:"p-3 w-full bg-neutral-200 dark:bg-neutral-700  border-black border-[.6px]",children:[`${t.suburb} (${t.total})`," "]}),children:t.streets.sort((l,b)=>l.street.localeCompare(b.street)).map((l,b)=>e.jsx("div",{className:"my-2 mx-6",children:e.jsx(N,{title:e.jsx("div",{className:"p-2 w-full bg-neutral-200 dark:bg-neutral-700 rounded",children:`${l.street} ${l.addresses.length}`}),children:e.jsx("div",{className:" grid grid-cols-[repeat(auto-fill,minmax(3.5rem,1fr))]",children:l.addresses.sort((r,u)=>r.houseNumber-u.houseNumber).map((r,u)=>e.jsx("div",{children:e.jsxs("div",{onClick:()=>{c(r),i(!0)},className:`m-1 py-2 rounded text-center ${r.houseNumber%2===0?"dark:bg-blue-800 bg-blue-300":"dark:bg-green-800 bg-green-300"}`,children:[r.unitNumber&&`${r.unitNumber}/`,r.houseNumber]})},u))})},b)},b))}),d&&e.jsx(k,{isOpen:d,address:h,setUpdateModelOpen:i})]},o))})},L=({mapNumbers:m})=>{console.log("MapsList >>> mapNumbers:",m);const[d,i]=p.useState(!1),[h,c]=p.useState({});return e.jsx("div",{className:"",children:m.filter(t=>t.mapNumber!==void 0).sort((t,o)=>o.total-t.total).map((t,o)=>e.jsxs("div",{className:"mx-auto w-full max-w-md p-2",children:[e.jsx(N,{title:e.jsx("div",{className:"p-3 w-full bg-neutral-200 dark:bg-neutral-700  border-black border-[.6px]",children:`Map ${t.mapNumber} (${t.total})`}),children:t.streets.sort((l,b)=>l.street.localeCompare(b.street)).map((l,b)=>e.jsx("div",{className:"my-2 mx-6",children:e.jsx(N,{title:e.jsx("div",{className:"p-2 w-full bg-neutral-200 dark:bg-neutral-700 rounded",children:`${l.street} ${l.addresses.length}`}),children:e.jsx("div",{className:" grid grid-cols-[repeat(auto-fill,minmax(3.5rem,1fr))]",children:l.addresses.sort((r,u)=>r.houseNumber-u.houseNumber).map((r,u)=>e.jsx("div",{children:e.jsxs("div",{onClick:()=>{c(r),i(!0)},className:`m-1 py-2 rounded text-center ${r.houseNumber%2===0?"dark:bg-blue-800 bg-blue-300":"dark:bg-green-800 bg-green-300"}`,children:[r.unitNumber&&`${r.unitNumber}/`,r.houseNumber]})},u))})},b)},b))}),d&&e.jsx(k,{isOpen:d,address:h,setUpdateModelOpen:i})]},o))})},E=({changeSubpage:m})=>{const[d,i]=p.useState([{key:""}]),[h,c]=p.useState([]),[t,o]=p.useState([]);return p.useEffect(()=>A(v(j,"notAtHomes","MaitlandCongregation"),b=>{const r=b.data(),u=r?Object.keys(r).map(s=>({key:s,...r[s]})):[];i(u),c(u.reduce((s,n)=>{if(n.letter)return s;const a=s.findIndex(x=>x.mapNumber===`${n.mapNumber}`);if(a<0)s.push({mapNumber:n.mapNumber,total:1,streets:[{street:n.street,addresses:[n]}]});else{s[a].total=s[a].total+1;const x=s[a].streets.findIndex(f=>f.street===`${n.street}`);x<0?s[a].streets.push({street:n.street,addresses:[n]}):s[a].streets[x].addresses.push(n)}return s},[])),o(u.reduce((s,n)=>{if(n.letter)return s;const a=s.findIndex(x=>x.suburb===`${n.suburb}`);if(a<0)s.push({suburb:n.suburb,total:1,streets:[{street:n.street,addresses:[n]}]});else{s[a].total=s[a].total+1;const x=s[a].streets.findIndex(f=>f.street===`${n.street}`);x<0?s[a].streets.push({street:n.street,addresses:[n]}):s[a].streets[x].addresses.push(n)}return s},[]))}),[]),e.jsx("div",{className:"h-full",children:e.jsx(y,{color:"blue",tabItems:[{title:"Suburb",content:e.jsx(C,{suburbs:t})},{title:"Map ID",content:e.jsx(L,{mapNumbers:h})}]})})};export{E as default};
